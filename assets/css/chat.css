/* Chat Panel Styles - Minimal custom styles, mostly using DaisyUI */

/* Only keep custom animations and utilities that DaisyUI doesn't provide */

/* Fix scrollbar-gutter jump when drawer opens */
/* Override DaisyUI's default behavior that causes layout shift */
html:has(.drawer-toggle:checked) {
  scrollbar-gutter: auto !important;
}

/* Desktop responsive behavior: Push main content when chat panel is open */
/* Only apply on large screens (1024px and above) */
@media (min-width: 1024px) {
  /* When chat drawer is checked (open), push the admin drawer content to the left */
  html:has(#chat-drawer-global-chat-panel:checked) .drawer:not(.drawer-end) > .drawer-content {
    margin-right: 384px; /* w-96 = 384px */
    transition: margin-right 0.3s ease-in-out;
  }

  /* Smooth transition when closing */
  .drawer:not(.drawer-end) > .drawer-content {
    transition: margin-right 0.3s ease-in-out;
  }

  /* Remove overlay on desktop - panel should not overlay content */
  /* Only hide the chat drawer's overlay, not the admin sidebar's */
  html:has(#chat-drawer-global-chat-panel:checked) .drawer.drawer-end .drawer-overlay {
    display: none;
  }

  /* Prevent drawer-side from capturing pointer events outside the panel */
  /* Only the panel content (ul.menu) should capture events */
  html:has(#chat-drawer-global-chat-panel:checked) .drawer.drawer-end .drawer-side {
    pointer-events: none;
  }

  /* Re-enable pointer events for the actual panel content */
  html:has(#chat-drawer-global-chat-panel:checked) .drawer.drawer-end .drawer-side > * {
    pointer-events: auto;
  }

  /* Ensure chat messages and their children can receive hover events */
  html:has(#chat-drawer-global-chat-panel:checked) .drawer.drawer-end .drawer-side .chat,
  html:has(#chat-drawer-global-chat-panel:checked) .drawer.drawer-end .drawer-side .chat * {
    pointer-events: auto;
  }

  /* Hide chat toggle button in topbar when panel is open */
  /* Only hide the topbar button, not the X button inside the panel */
  /* Target the navbar inside drawer-content (topbar), not the one inside the panel */
  html:has(#chat-drawer-global-chat-panel:checked) .drawer-content .navbar label[for="chat-drawer-global-chat-panel"] {
    display: none;
  }

  /* Add padding to topbar to align notification bell with main content's right edge */
  /* Match the lg:p-8 (2rem) padding that main content uses */
  html:has(#chat-drawer-global-chat-panel:checked) .drawer-content > .navbar {
    padding-right: 2rem;
  }
}

/* Insert into note link styles */
/* Use DaisyUI's chat-footer with native link styling */
.chat-footer {
  @apply transition-opacity duration-200 ease-in-out;
}

/* Show insert link on hover */
@important {
  .chat:hover .chat-footer {
    @apply opacity-100;
  }
}

/* Markdown styling in chat bubbles */
.chat-markdown {
  @apply leading-relaxed;
}

.chat-markdown p {
  @apply mb-3;
}

.chat-markdown p:last-child {
  @apply mb-0;
}

.chat-markdown strong {
  @apply font-semibold;
}

.chat-markdown em {
  @apply italic;
}

.chat-markdown code {
  @apply bg-black/10 dark:bg-white/10 px-1 py-0.5 rounded font-mono text-[0.875em];
}

.chat-markdown pre {
  @apply bg-black/5 dark:bg-white/5 p-3 rounded-md overflow-x-auto mb-3;
}

.chat-markdown pre code {
  @apply bg-transparent p-0 text-sm;
}

.chat-markdown ul,
.chat-markdown ol {
  @apply mb-3 pl-6 list-outside block;
}

.chat-markdown ul {
  @apply list-disc;
}

.chat-markdown ol {
  @apply list-decimal;
}

.chat-markdown li {
  @apply mb-1;
  display: list-item !important;
}

/* Task list (checkbox) styling */
.chat-markdown ul:has(input[type="checkbox"]) {
  @apply list-none pl-2;
}

.chat-markdown li:has(input[type="checkbox"]) {
  @apply list-none ml-0 grid grid-cols-[auto_1fr] gap-2 items-start;
  display: grid !important;
}

/* Ensure content after checkbox doesn't break layout */
.chat-markdown li:has(input[type="checkbox"]) > :not(input[type="checkbox"]) {
  @apply m-0 inline;
}

.chat-markdown input[type="checkbox"] {
  @apply w-4 h-4 mt-0.5 cursor-default pointer-events-none;
  appearance: auto;
  -webkit-appearance: checkbox;
  -moz-appearance: checkbox;
}

.chat-markdown del {
  @apply line-through opacity-70;
}

.chat-markdown h1,
.chat-markdown h2,
.chat-markdown h3,
.chat-markdown h4,
.chat-markdown h5,
.chat-markdown h6 {
  @apply font-semibold mt-4 mb-2;
}

.chat-markdown h1 { @apply text-2xl; }
.chat-markdown h2 { @apply text-xl; }
.chat-markdown h3 { @apply text-lg; }

.chat-markdown blockquote {
  @apply border-l-4 border-current pl-4 opacity-80 mb-3;
}

.chat-markdown a {
  @apply text-primary underline;
}

.chat-markdown a:hover {
  @apply opacity-80;
}

/* Accessibility */
@media (prefers-reduced-motion: reduce) {
  * {
    transition: none !important;
    animation: none !important;
  }

  .chat-footer {
    transition: none !important;
  }

  /* Disable panel transitions for reduced motion */
  .drawer:not(.drawer-end) > .drawer-content {
    transition: none !important;
  }
}
