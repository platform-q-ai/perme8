/* Chat Panel Styles - Minimal custom styles, mostly using DaisyUI */

/* Only keep custom animations and utilities that DaisyUI doesn't provide */

/* Fix scrollbar-gutter jump when drawer opens */
/* Override DaisyUI's default behavior that causes layout shift */
html:has(.drawer-toggle:checked) {
  scrollbar-gutter: auto !important;
}

/* Desktop responsive behavior: Push main content when chat panel is open */
/* Only apply on large screens (1024px and above) */
@media (min-width: 1024px) {
  /* When chat drawer is checked (open), push the admin drawer content to the left */
  html:has(#chat-drawer-global-chat-panel:checked) .drawer:not(.drawer-end) > .drawer-content {
    margin-right: 384px; /* w-96 = 384px */
    transition: margin-right 0.3s ease-in-out;
  }

  /* Smooth transition when closing */
  .drawer:not(.drawer-end) > .drawer-content {
    transition: margin-right 0.3s ease-in-out;
  }

  /* Remove overlay on desktop - panel should not overlay content */
  /* Only hide the chat drawer's overlay, not the admin sidebar's */
  html:has(#chat-drawer-global-chat-panel:checked) .drawer.drawer-end .drawer-overlay {
    display: none;
  }

  /* Prevent drawer-side from capturing pointer events outside the panel */
  /* Only the panel content (ul.menu) should capture events */
  html:has(#chat-drawer-global-chat-panel:checked) .drawer.drawer-end .drawer-side {
    pointer-events: none;
  }

  /* Re-enable pointer events for the actual panel content */
  html:has(#chat-drawer-global-chat-panel:checked) .drawer.drawer-end .drawer-side > * {
    pointer-events: auto;
  }

  /* Ensure chat messages and their children can receive hover events */
  html:has(#chat-drawer-global-chat-panel:checked) .drawer.drawer-end .drawer-side .chat,
  html:has(#chat-drawer-global-chat-panel:checked) .drawer.drawer-end .drawer-side .chat * {
    pointer-events: auto;
  }

  /* Hide chat toggle button in topbar when panel is open */
  /* Only hide the topbar button, not the X button inside the panel */
  /* Target the navbar inside drawer-content (topbar), not the one inside the panel */
  html:has(#chat-drawer-global-chat-panel:checked) .drawer-content .navbar label[for="chat-drawer-global-chat-panel"] {
    display: none;
  }

  /* Add padding to topbar to align notification bell with main content's right edge */
  /* Match the lg:p-8 (2rem) padding that main content uses */
  html:has(#chat-drawer-global-chat-panel:checked) .drawer-content > .navbar {
    padding-right: 2rem;
  }
}

/* Insert into note link styles */
/* Use DaisyUI's chat-footer with native link styling */
.chat-footer {
  transition: opacity 0.2s ease-in-out;
}

/* Show insert link on hover */
.chat:hover .chat-footer {
  opacity: 1 !important;
}

/* Markdown styling in chat bubbles */
.chat-markdown {
  /* Typography */
  line-height: 1.6;
}

.chat-markdown p {
  margin-bottom: 0.75rem;
}

.chat-markdown p:last-child {
  margin-bottom: 0;
}

.chat-markdown strong {
  font-weight: 600;
}

.chat-markdown em {
  font-style: italic;
}

.chat-markdown code {
  background-color: rgba(0, 0, 0, 0.1);
  padding: 0.125rem 0.25rem;
  border-radius: 0.25rem;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
  font-size: 0.875em;
}

[data-theme="dark"] .chat-markdown code {
  background-color: rgba(255, 255, 255, 0.1);
}

.chat-markdown pre {
  background-color: rgba(0, 0, 0, 0.05);
  padding: 0.75rem;
  border-radius: 0.375rem;
  overflow-x: auto;
  margin-bottom: 0.75rem;
}

[data-theme="dark"] .chat-markdown pre {
  background-color: rgba(255, 255, 255, 0.05);
}

.chat-markdown pre code {
  background-color: transparent;
  padding: 0;
  font-size: 0.875rem;
}

.chat-markdown ul,
.chat-markdown ol {
  margin-bottom: 0.75rem;
  padding-left: 1.5rem;
  list-style-position: outside;
  display: block;
}

.chat-markdown ul {
  list-style-type: disc !important;
}

.chat-markdown ol {
  list-style-type: decimal !important;
}

.chat-markdown li {
  margin-bottom: 0.25rem;
  display: list-item !important;
}

/* Task list (checkbox) styling */
.chat-markdown ul:has(input[type="checkbox"]) {
  list-style-type: none !important;
  padding-left: 0.5rem;
}

.chat-markdown li:has(input[type="checkbox"]) {
  list-style-type: none !important;
  margin-left: 0;
  display: grid !important;
  grid-template-columns: auto 1fr;
  gap: 0.5rem;
  align-items: start;
}

/* Ensure content after checkbox doesn't break layout */
.chat-markdown li:has(input[type="checkbox"]) > :not(input[type="checkbox"]) {
  margin: 0;
  display: inline;
}

.chat-markdown input[type="checkbox"] {
  appearance: auto;
  -webkit-appearance: checkbox;
  -moz-appearance: checkbox;
  width: 1rem;
  height: 1rem;
  margin-top: 0.125rem;
  cursor: default;
  pointer-events: none;
}

.chat-markdown del {
  text-decoration: line-through;
  opacity: 0.7;
}

.chat-markdown h1,
.chat-markdown h2,
.chat-markdown h3,
.chat-markdown h4,
.chat-markdown h5,
.chat-markdown h6 {
  font-weight: 600;
  margin-top: 1rem;
  margin-bottom: 0.5rem;
}

.chat-markdown h1 { font-size: 1.5rem; }
.chat-markdown h2 { font-size: 1.25rem; }
.chat-markdown h3 { font-size: 1.125rem; }

.chat-markdown blockquote {
  border-left: 0.25rem solid currentColor;
  padding-left: 1rem;
  opacity: 0.8;
  margin-bottom: 0.75rem;
}

.chat-markdown a {
  color: hsl(var(--p));
  text-decoration: underline;
}

.chat-markdown a:hover {
  opacity: 0.8;
}

/* Accessibility */
@media (prefers-reduced-motion: reduce) {
  * {
    transition: none !important;
    animation: none !important;
  }

  .chat-footer {
    transition: none !important;
  }

  /* Disable panel transitions for reduced motion */
  .drawer:not(.drawer-end) > .drawer-content {
    transition: none !important;
  }
}
